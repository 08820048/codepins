<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>cn.ilikexff.codepins</id>
    <name>CodePins - Code Bookmarks</name>
    <vendor email="ilikexff@gmail.com" url="https://github.com/08820048/codepins-intellij-plugin">ilikexff</vendor>
    <version>1.1.3</version>

    <!-- 产品描述符，用于许可证验证 -->
    <product-descriptor code="***REMOVED_PRODUCT_CODE***" release-date="20240501" release-version="1.2.0" optional="true"/>

    <!-- 插件兼容性信息 -->
    <idea-version since-build="241" until-build="252.*"/>

    <!-- 插件分类标签 -->
    <category>Navigation</category>
    <category>Code Tools</category>

    <!-- 插件描述 -->
    <!-- 注意：Marketplace要求插件描述必须使用拉丁字符（英文），并且长度至少为40个字符 -->
    <description><![CDATA[
        <h2>CodePins - The Modern Code Bookmarking Solution</h2>

        <p>CodePins is a sophisticated code bookmarking tool designed to enhance your coding workflow in complex projects. It allows you to pin important code locations, add notes, and quickly navigate between them with elegant UI and powerful features.</p>

        <h3>Why Choose CodePins?</h3>

        <p>Unlike traditional bookmarks, CodePins offers a modern, intuitive experience with rich features like code previews, custom tags, drag-and-drop organization, and keyboard shortcuts - all designed to help you maintain focus and productivity.</p>

        <h3>Key Features</h3>

        <ul>
            <li><strong>Smart Bookmarking:</strong> Pin any line or code block with a single click or keyboard shortcut</li>
            <li><strong>Rich Annotations:</strong> Add custom notes and tags to each pin for better organization</li>
            <li><strong>Instant Preview:</strong> Hover over pins to preview code without switching context</li>
            <li><strong>Keyboard Navigation:</strong> Navigate between pins using intuitive keyboard shortcuts</li>
            <li><strong>Customizable Organization:</strong> Drag and drop pins to reorder them according to your workflow</li>
            <li><strong>Powerful Search:</strong> Quickly find pins by filename, path, note content, or tags</li>
            <li><strong>Adaptive UI:</strong> Beautiful interface that adapts to both light and dark themes</li>
            <li><strong>Auto-Update:</strong> Pin positions automatically update as you edit code</li>
            <li><strong>Import/Export:</strong> Share pins between projects or team members</li>
            <li><strong>Persistent Storage:</strong> Pin information is preserved after IDE restart</li>
        </ul>

        <h3>Perfect For</h3>

        <ul>
            <li>Navigating large codebases and complex projects</li>
            <li>Onboarding new team members by highlighting important code sections</li>
            <li>Tracking TODOs and points of interest during code reviews</li>
            <li>Creating a personal map of important code locations</li>
            <li>Maintaining context when working across multiple files</li>
        </ul>

        <p>CodePins seamlessly integrates with your development workflow, helping you stay organized and focused on what matters most - writing great code.</p>

        <h3>License</h3>
        <p>This plugin is available under the MIT License. See the project repository for more details.</p>
    ]]></description>

    <!-- 详细描述已包含在 description 标签中 -->
    <!-- 注意：pluginDescription 不是标准标签，已移除 -->

    <!-- Plugin Change Notes -->
    <change-notes><![CDATA[
<h2>Version 1.1.3</h2>
<ul>
    <li><b>FREEMIUM Business Model:</b> Implemented Professional and Free editions</li>
    <li><b>Watermark Improvements:</b> Simplified to text-only watermark option</li>
    <li><b>UI Enhancements:</b> Better theme compatibility for upgrade prompts</li>
    <li><b>Bug Fix:</b> Fixed button display issues in light themes</li>
    <li><b>Premium Features:</b> Added unified upgrade dialog</li>
    <li><b>System Optimization:</b> Improved license verification</li>
    <li><b>Social Sharing:</b> Clearer premium feature indicators</li>
    <li><b>Theme Support:</b> Enhanced UI consistency across light and dark themes</li>
</ul>

<h2>Version 1.1.2</h2>
<ul>
    <li><b>Export/Import:</b> Fixed functionality with improved UI</li>
    <li><b>UI Optimization:</b> Better support for light themes</li>
    <li><b>Drag and Drop:</b> Added manual pin reordering</li>
    <li><b>Keyboard Shortcuts:</b> Alt+Shift+P to add pin, Alt+Shift+Left/Right to navigate</li>
    <li><b>Search Box:</b> Modern design with dark theme support</li>
    <li><b>Code Preview:</b> Enhanced cards with sophisticated styling</li>
    <li><b>Animations:</b> Added effects when hovering over list items</li>
    <li><b>Icons:</b> Updated for import/export functionality</li>
</ul>

<h2>Version 1.1.1</h2>
<ul>
    <li><b>Hover Preview:</b> Improved functionality, resolved thread safety issues</li>
    <li><b>Code Preview UI:</b> Dynamic height adjustment based on code length</li>
    <li><b>Pin List:</b> Completely redesigned with modern card-style</li>
    <li><b>Empty State:</b> Added view with friendly guidance</li>
    <li><b>Search Field:</b> Enhanced visual feedback and user experience</li>
    <li><b>Tag System:</b> Better organization and filtering of pins</li>
</ul>

<h2>Version 1.0.0</h2>
<ul>
    <li><b>Initial Release:</b> Core functionality for code bookmarking</li>
    <li><b>Pin Management:</b> Add, delete, search, and manage code pins</li>
    <li><b>Code Marking:</b> Support for blocks and single line marking</li>
    <li><b>Modern UI:</b> Clean design and optimized user experience</li>
    <li><b>Notes:</b> Support for pin notes and quick preview</li>
</ul>
    ]]></change-notes>

    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="com.intellij">
        <toolWindow id="CodePins"
                    anchor="left"
                    factoryClass="cn.ilikexff.codepins.PinsToolWindow"
                    icon="/icons/logo_13x13.svg"
        />

        <!-- 注册服务类 -->
        <applicationService serviceImplementation="cn.ilikexff.codepins.PinStateService"/>
        <applicationService serviceImplementation="cn.ilikexff.codepins.settings.CodePinsSettings"/>
        <applicationService serviceImplementation="cn.ilikexff.codepins.services.GistService"/>
        <applicationService serviceImplementation="cn.ilikexff.codepins.services.LicenseService"/>
        <applicationService serviceImplementation="cn.ilikexff.codepins.services.IconPreloader"/>

        <!-- 图标预加载器 -->
        <postStartupActivity implementation="cn.ilikexff.codepins.services.IconPreloader"/>

        <!-- 注册设置页面 -->
        <applicationConfigurable parentId="tools" instance="cn.ilikexff.codepins.settings.CodePinsSettingsConfigurable"
                             id="cn.ilikexff.codepins.settings.CodePinsSettingsConfigurable"
                             displayName="CodePins Settings"/>
    </extensions>

    <actions>
        <!-- 右键菜单添加图钉 -->
        <action id="CodePins.PinAction"
                class="cn.ilikexff.codepins.PinAction"
                text="Pin This Line"
                description="Pin current line for later reference"
                icon="/icons/bookmark.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>

        <!-- 快捷键添加图钉 -->
        <action id="CodePins.AddPinAction"
                class="cn.ilikexff.codepins.actions.AddPinAction"
                text="Add Pin at Cursor"
                description="Add a pin at the current cursor position"
                icon="/icons/pin-add.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift P"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 导航到下一个图钉 -->
        <action id="CodePins.NavigateNextPinAction"
                class="cn.ilikexff.codepins.actions.NavigateNextPinAction"
                text="Navigate to Next Pin"
                description="Navigate to the next pin"
                icon="/icons/pin-next.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift RIGHT"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 导航到上一个图钉 -->
        <action id="CodePins.NavigatePrevPinAction"
                class="cn.ilikexff.codepins.actions.NavigatePrevPinAction"
                text="Navigate to Previous Pin"
                description="Navigate to the previous pin"
                icon="/icons/pin-prev.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift LEFT"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 切换图钉工具窗口 -->
        <action id="CodePins.TogglePinsToolWindowAction"
                class="cn.ilikexff.codepins.actions.TogglePinsToolWindowAction"
                text="Toggle CodePins Tool Window"
                description="Show or hide the CodePins tool window"
                icon="/icons/pin-toggle.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift T"/>
            <add-to-group group-id="ToolWindowsGroup" anchor="last"/>
        </action>

        <!-- 创建 CodePins 操作组 -->
        <group id="CodePins.ActionGroup" text="CodePins" description="CodePins actions" popup="true">
            <reference ref="CodePins.AddPinAction"/>
            <reference ref="CodePins.NavigateNextPinAction"/>
            <reference ref="CodePins.NavigatePrevPinAction"/>
            <reference ref="CodePins.TogglePinsToolWindowAction"/>
            <add-to-group group-id="MainMenu" anchor="last"/>
        </group>
    </actions>
</idea-plugin>
