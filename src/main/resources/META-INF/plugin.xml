<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>cn.ilikexff.codepins</id>
    <name>CodePins - Code Bookmarks</name>
    <vendor email="ilikexff@gmail.com" url="https://github.com/08820048/codepins-intellij-plugin">ilikexff</vendor>
    <version>1.1.2</version>

    <!-- 插件兼容性信息 -->
    <idea-version since-build="241" until-build="241.*"/>

    <!-- 插件分类标签 -->
    <category>Navigation</category>
    <category>Code Tools</category>

    <!-- 插件描述 -->
    <!-- 注意：Marketplace要求插件描述必须使用拉丁字符（英文），并且长度至少为40个字符 -->
    <description><![CDATA[
        A modern code bookmarking tool that helps you quickly navigate and manage important code locations in complex projects. Pin any line or code block, add notes, search, and preview code without leaving your current editing position.

        Key Features:
        - Code Bookmarking: Pin any line or code block for quick reference and navigation
        - Add Notes: Attach custom notes to each pin to record important information
        - Quick Search: Quickly find pins by filename, path, or note content
        - Code Preview: Hover to view pin details without leaving your current position
        - Auto-Update: Pin positions automatically update as you edit code
        - Persistent Storage: Pin information is preserved after IDE restart
    ]]></description>

    <!-- 详细描述已包含在 description 标签中 -->
    <!-- 注意：pluginDescription 不是标准标签，已移除 -->

    <!-- Plugin Change Notes -->
    <change-notes><![CDATA[
        Version 1.1.2:
        - Fixed export/import functionality with improved UI and user experience
        - Optimized pin list style with better support for light themes
        - Added drag and drop functionality for manual pin reordering
        - Added keyboard shortcut support (Alt+Shift+P to add pin, Alt+Shift+Left/Right to navigate)
        - Improved search box with modern design and dark theme support
        - Enhanced code preview cards with sophisticated styling and theme adaptation
        - Added animation effects when hovering over list items
        - Updated icons for import/export functionality

        Version 1.1.1:
        - Improved hover preview functionality, resolving thread safety issues
        - Enhanced code preview UI with dynamic height adjustment based on code length
        - Completely redesigned pin list items with modern card-style design
        - Added empty state view with friendly guidance information
        - Improved search field with enhanced visual feedback and user experience
        - Added tag system for better organization and filtering of pins

        Version 1.0.0:
        - Initial release
        - Support for adding, deleting, searching, and managing code pins
        - Support for code blocks and single line code marking
        - Modern UI design and user experience optimization
        - Support for pin notes and quick preview functionality
    ]]></change-notes>

    <depends>com.intellij.modules.platform</depends>

    <extensions defaultExtensionNs="com.intellij">
        <toolWindow id="CodePins"
                    anchor="left"
                    factoryClass="cn.ilikexff.codepins.PinsToolWindow"
                    icon="/icons/logo.svg"
        />

        <!-- 注册服务类 -->
        <applicationService serviceImplementation="cn.ilikexff.codepins.PinStateService"/>
        <applicationService serviceImplementation="cn.ilikexff.codepins.settings.CodePinsSettings"/>

        <!-- 注册设置页面 -->
        <applicationConfigurable parentId="tools" instance="cn.ilikexff.codepins.settings.CodePinsSettingsConfigurable"
                             id="cn.ilikexff.codepins.settings.CodePinsSettingsConfigurable"
                             displayName="CodePins Settings"/>
    </extensions>

    <actions>
        <!-- 右键菜单添加图钉 -->
        <action id="CodePins.PinAction"
                class="cn.ilikexff.codepins.PinAction"
                text="Pin This Line"
                description="Pin current line for later reference"
                icon="/icons/logo.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>

        <!-- 快捷键添加图钉 -->
        <action id="CodePins.AddPinAction"
                class="cn.ilikexff.codepins.actions.AddPinAction"
                text="Add Pin at Cursor"
                description="Add a pin at the current cursor position"
                icon="/icons/pin-add.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift P"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 导航到下一个图钉 -->
        <action id="CodePins.NavigateNextPinAction"
                class="cn.ilikexff.codepins.actions.NavigateNextPinAction"
                text="Navigate to Next Pin"
                description="Navigate to the next pin"
                icon="/icons/pin-next.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift RIGHT"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 导航到上一个图钉 -->
        <action id="CodePins.NavigatePrevPinAction"
                class="cn.ilikexff.codepins.actions.NavigatePrevPinAction"
                text="Navigate to Previous Pin"
                description="Navigate to the previous pin"
                icon="/icons/pin-prev.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift LEFT"/>
            <add-to-group group-id="EditorActions" anchor="last"/>
        </action>

        <!-- 切换图钉工具窗口 -->
        <action id="CodePins.TogglePinsToolWindowAction"
                class="cn.ilikexff.codepins.actions.TogglePinsToolWindowAction"
                text="Toggle CodePins Tool Window"
                description="Show or hide the CodePins tool window"
                icon="/icons/pin-toggle.svg">
            <keyboard-shortcut keymap="$default" first-keystroke="alt shift T"/>
            <add-to-group group-id="ToolWindowsGroup" anchor="last"/>
        </action>

        <!-- 创建 CodePins 操作组 -->
        <group id="CodePins.ActionGroup" text="CodePins" description="CodePins actions" popup="true">
            <reference ref="CodePins.AddPinAction"/>
            <reference ref="CodePins.NavigateNextPinAction"/>
            <reference ref="CodePins.NavigatePrevPinAction"/>
            <reference ref="CodePins.TogglePinsToolWindowAction"/>
            <add-to-group group-id="MainMenu" anchor="last"/>
        </group>
    </actions>
</idea-plugin>
